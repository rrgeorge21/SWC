var SV=window.SV||{};
(function(c,e,f,g){SV.TransparentAsSpoiler=XF.Element.newHandler({options:{svShowIcon:null,svHideIcon:null,storageContainer:"toggleTransparencyToSpoiler",storageKey:"toggle"},colorSpans:null,init:function(){var a=this.$target;this.colorSpans=this.findSpans(this.findMessageBody(a));if(this.colorSpans.length){var b=XF.ToggleStorageData.get(this.options.storageContainer,this.options.storageKey);a.prepend(c("<span />",{class:(b?this.options.svHideIcon:this.options.svShowIcon)+" sv-transparent-as-spoiler"}).on("click",XF.proxy(this,
"click")));b&&this.showSpoiler()}},findMessageBody:function(a){return a.closest(".message-main").find(".message-userContent .message-body")},findSpans:function(a){var b=a.css("background-color");return a.find(".fixed-color").filter(function(){var a=this.style.color;return"transparent"===a||a==b?!0:!1})},showSpoiler:function(){var a=this;this.colorSpans.addClass("bbc-spoiler").addClass("bbc-spoiler-instant");setTimeout(function(){a.colorSpans.removeClass("bbc-spoiler-instant")},1)},hideSpoiler:function(){this.colorSpans.removeClass("bbc-spoiler")},
click:function(a){if(this.colorSpans){a=c(a.target);var b=this.options.svShowIcon,d=this.options.svHideIcon;a.hasClass(b)?(a.removeClass(b),a.addClass(d),XF.ToggleStorageData.set(this.options.storageContainer,this.options.storageKey,1,2592E3),this.showSpoiler()):(a.removeClass(d),a.addClass(b),XF.ToggleStorageData.remove(this.options.storageContainer,this.options.storageKey),this.hideSpoiler())}}});XF.Element.register("sv-transparent-as-spoiler","SV.TransparentAsSpoiler")})(jQuery,window,document);
